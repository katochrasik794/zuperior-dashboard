// server/prisma/schema.prisma
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id               String      @id @default(uuid())
  clientId String  @unique     @default(cuid())
  email            String      @unique
  password         String      // Hashed password
  name             String?
  phone            String?
  country          String?
  createdAt        DateTime    @default(now())
  accounts         Account[]
  transactions     Transaction[]
  kyc              KYC?
}

model Account {
  id               String      @id @default(uuid())
  accountId        String      @unique // MT5 Account ID
  platform         String      @default("MT5")
  leverage         Int
  balance          Float
  equity           Float
  userId           String
  user             User        @relation(fields: [userId], references: [id])
}

model Transaction {
  id               String      @id @default(uuid())
  type             String      // "Deposit" or "Withdrawal"
  amount           Float
  status           String      // "Pending", "Completed", "Failed"
  user             User        @relation(fields: [userId], references: [id])
  userId           String
  createdAt        DateTime    @default(now())
}

model KYC {
  id               String      @id @default(uuid())
  isDocumentVerified Boolean   @default(false)
  isAddressVerified  Boolean   @default(false)
  verificationStatus String      @default("Pending")
  user             User        @relation(fields: [userId], references: [id])
  userId           String      @unique
}
